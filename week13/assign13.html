<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=Lobster&family=Roboto&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="./css/main.css">
  <title>Darrin Fry Week 12 Mileage Calculator</title>
  <meta name="description" content="Mileage Calculator CS213 Week 12">

</head>

<body class="body-group" onload="loadDisplay()" onchange="validateInput()">
  <header class="header-group">
    <div>
      <div class="heading">
        <h1>Week 12 Mileage Calculator</h1>
        <h3>Point to Point Distance Calculator</h3>
      </div>
      <nav>
        <ul class="navigation">
          <li><a class="ham" href="#">&#9776; Menu</a></li>
          <li><a class="index" href="../index.html">CS213 Assignments</a></li>

        </ul>
      </nav>
    </div>
  </header>

  <div class="hero-image">
  </div>

  <div class="main-content">
    <div class="content-grid">
      <div id="form-input">
        <div class="player">
          <h3>Please enjoy this audio sampling of previous a previous entry.</h3>

          <video controls="" autoplay name="media">
            <source src="http://soundsofdisneyland.com/AudioFiles/Club%2033/15%20Grim%20Grinning%20Ghosts.mp3"
              type="audio/mpeg"></video>
        </div>
        <div id="regForm">
          <h3>Please fill out the form and click submit</h3>
          <p style="text-align: center;"> Your accepted registration will be show below.</p>
          <form>

            <div>
              <h4>Performance Type</h4>
              <label><input type="radio" name="performance" value="Solo" oninput="removeStudent()">Solo</label><br>
              <label><input type="radio" name="performance" value="Duet" oninput="addStudent()">Duet</label><br>
              <label><input type="radio" name="performance" value="Concerto" oninput="removeStudent()">Concerto</label>
            </div>

            <div id="studentInfo">
              <h4>Student Information</h4>
              <label class="top" for="first_name">First Name</label>
              <input type="text" name="first_name" id="first_name">

              <label class="top" for="last_name">Last Name</label>
              <input type="text" name="last_name" id="last_name">

              <label class="top" for="student_id">Student ID</label>
              <input type="number" name="student_id" id="student_id">
            </div>

            <div>
              <h4>Performance Information</h4>
              <label class="top" for="skill">Skill Level</label>
              <select name="skill" id="skill">
                <option disabled selected id="skill_select">Select</option>
                <option value="Beginner">Beginner</option>
                <option value="Intermediate">Intermediate</option>
                <option value="Pre-advanced">Pre-advanced</option>
                <option value="Advanced">Advanced</option>
              </select>

              <label class="top">Instrument</label>
              <select name="instrument" id="instrument">
                <option disabled selected id="instrument_select">Select</option>
                <option id="instrument_0" value="Piano">Piano</option>
                <option id="instrument_1" value="Voice">Voice</option>
                <option id="instrument_2" value="String">String</option>
                <option id="instrument_3" value="Organ">Organ</option>
                <option id="instrument_4" value="Other">Other</option>
              </select>
              <br><br>
              <label class="top" for="location">Name of Building</label>
              <input type="text" name="location" id="location">

              <label class="top" for="room">Room Number</label>
              <input type="number" name="room" id="room">

              <label class="top" for="time_slot">Time Slot</label>
              <select name="time_slot" id="time_slot">
                <option disabled selected id="time_select">Select</option>
                <option value="8:00">8:00am</option>
                <option value="8:15">8:15am</option>
                <option value="8:30">8:30am</option>
                <option value="8:45">8:45am</option>
                <option value="9:00">9:00am</option>
              </select>
            </div>
            <br><br>
            <input type="submit" name="register" id="register" value="Register" onclick="updateDisplay()">

            <input type="reset" name="clear" id="clear" value="Clear" onclick="resetForm()">
          
            <p id="message" style="font-size: larger; font-weight: bold; color: red;"></p>

          </form>
        </div>
        <div class="display">
          <h3>Registered Performances</h3>
          <table>
            <thead>
              <tr>
                <td>Student(s)</td>
                <td>Location</td>
                <td>Time</td>
                <td>Performance</td>
              </tr>
            </thead>
            <tbody id="registered">

            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>


  <footer class="footer-content">
    <p>&copy; 2020 | Darrin Fry | Utah |
      <a href="https://www.byui.edu/online " target="_blank">BYUI Online Learning</a> </p>
    <script>
      const hambutton = document.querySelector(".ham");
      hambutton.addEventListener("click", toggleMenu, false);

      function toggleMenu() {
        document.querySelector(".navigation").classList.toggle("responsive");
      }
    </script>
    <script>
      function addStudent() {
        let secondStudent = document.getElementById('secondStudent');
        if (secondStudent == null) {
          let form = document.getElementById('studentInfo');

          let student2 = document.createElement('div');

          let p = document.createElement('p');

          let fNameLabel = document.createElement('label');
          let fNameInput = document.createElement('input');

          let lNameLabel = document.createElement('label');
          let lNameInput = document.createElement('input');

          let idLabel = document.createElement('label');
          let idInput = document.createElement('input');

          student2.setAttribute("id", "secondStudent");

          p.setAttribute("id", "student_2");
          p.textContent = "Duet partner:";

          fNameLabel.setAttribute("class", "top");
          fNameLabel.setAttribute("for", "first_name_2");
          fNameLabel.textContent = "First Name";
          fNameInput.setAttribute("type", "text");
          fNameInput.setAttribute("name", "first_name_2");
          fNameInput.setAttribute("id", "first_name_2");

          lNameLabel.setAttribute("class", "top");
          lNameLabel.setAttribute("for", "last_name_2");
          lNameLabel.textContent = "Last Name";
          lNameInput.setAttribute("type", "text");
          lNameInput.setAttribute("name", "last_name_2");
          lNameInput.setAttribute("id", "last_name_2");

          idLabel.setAttribute("class", "top");
          idLabel.setAttribute("for", "student_id_2");
          idLabel.textContent = "Student ID";
          idInput.setAttribute("type", "number");
          idInput.setAttribute("name", "student_id_2");
          idInput.setAttribute("id", "student_id_2");

          student2.appendChild(p);
          student2.appendChild(fNameLabel);
          student2.appendChild(fNameInput);
          student2.appendChild(lNameLabel);
          student2.appendChild(lNameInput);
          student2.appendChild(idLabel);
          student2.appendChild(idInput);

          form.appendChild(student2);
        }
      }

      function removeStudent() {
        let student2 = document.getElementById('secondStudent');
        if (student2 != null) {
          student2.remove();
        }
      }

      function resetForm() {
        document.getElementById('message').innerHTML = "";
        document.getElementById('performance').focus();
      }

      function validateInput() {
        let message = document.getElementById('message');
        let performance = document.getElementsByName('performance');
        let first_name = document.getElementById('first_name');
        let last_name = document.getElementById('last_name');
        let student_id = document.getElementById('student_id');
        let first_name_2 = document.getElementById('first_name_2');
        let last_name_2 = document.getElementById('last_name_2');
        let student_id_2 = document.getElementById('student_id_2');
        let skill = document.getElementById('skill_select');
        let location = document.getElementById('location');
        let room = document.getElementById('room');
        let time_slot = document.getElementById('time_select');
        let instrument = document.getElementById('instrument_select');

        if (!performance[0].checked && !performance[1].checked && !performance[2].checked) {
          message.innerHTML = "Fill out all fields";
          document.getElementById("register").disabled = true;
          return false;
        } else if (first_name.value == "") {
          message.innerHTML = "Fill out all fields";
          first_name.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (last_name.value == "") {
          message.innerHTML = "Fill out all fields";
          last_name.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (student_id.value == "") {
          message.innerHTML = "Fill out all fields";
          student_id.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (first_name_2 != null && first_name_2 == "") {
          message.innerHTML = "Fill out all fields";
          first_name_2.focus();
          document.getElementById("register").disabled = true;;
          return false;
        } else if (last_name_2 != null && last_name_2 == "") {
          message.innerHTML = "Fill out all fields";
          last_name_2.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (student_id_2 != null && student_id_2 == "") {
          message.innerHTML = "Fill out all fields";
          student_id_2.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (skill.selected) {
          message.innerHTML = "Fill out all fields";
          skill.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (instrument.selected) {
          message.innerHTML = "Fill out all fields";
          instrument.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (location == "") {
          message.innerHTML = "Fill out all fields";
          location.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (room == "") {
          message.innerHTML = "Fill out all fields";
          room.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else if (time_slot.selected) {
          message.innerHTML = "Fill out all fields";
          time_slot.focus();
          document.getElementById("register").disabled = true;
          return false;
        } else {
          document.getElementById("register").disabled = false;
          return true;
        }
      }

      function updateDisplay() {
        if (validateInput()) {
          let pType = document.getElementsByName('performance');
          for (i = 0; i < pType.length; i++) {
            if (pType[i].checked) {
              var performance = pType[i].value;
            }
          }
          let first_name = document.getElementById('first_name').value;
          let last_name = document.getElementById('last_name').value;
          let student_id = document.getElementById('student_id').value;
          let fn_2 = document.getElementById('first_name_2');
          if (fn_2 != null) {
            var first_name_2 = fn_2.value;
            var last_name_2 = document.getElementById('last_name_2').value;
            var student_id_2 = document.getElementById('student_id_2').value;
          }

          let skill = document.getElementById('skill');
          let opt = skill.options[skill.selectedIndex];
          skill = opt.value;

          let instrument = document.getElementById('instrument');
          let opt2 = instrument.options[instrument.selectedIndex];
          instrument = opt2.value;

          let location = document.getElementById('location').value;
          let room = document.getElementById('room').value;

          let time = document.getElementById('time_slot');
          let opt3 = time.options[time.selectedIndex];
          time = opt3.value;

          if (first_name_2 == null) {
            var vars = "performance=" + performance + "&first_name=" + first_name +
              "&last_name=" + last_name + "&student_id=" + student_id + "&skill=" + skill +
              "&instrument=" + instrument + "&location=" + location + "&room=" + room +
              "&time_slot=" + time;
          } else {
            var vars = "performance=" + performance + "&first_name=" + first_name +
              "&last_name=" + last_name + "&student_id=" + student_id + "&first_name_2=" + first_name_2 +
              "&last_name_2=" + last_name_2 + "&student_id_2=" + student_id_2 + "&skill=" + skill +
              "&instrument=" + instrument + "&location=" + location + "&room=" + room +
              "&time_slot=" + time;
          }

          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function () {
            console.log(xhttp);
            if (this.readyState == 4 && this.status == 200) {
              let response = this.responseText.split("\n");
              for (let i = 0; i < response.length - 1; i++) {
                let cells = response[i].split(",");
                var row = document.createElement('tr');
                var tdName = document.createElement('td');
                var tdLocation = document.createElement('td');
                var tdTime = document.createElement('td');
                var tdPerformance = document.createElement('td');

                tdName.textContent = cells[0];
                tdLocation.innerHTML = cells[1];
                tdTime.textContent = cells[2];
                tdPerformance.textContent = cells[3];

                row.appendChild(tdName);
                row.appendChild(tdLocation);
                row.appendChild(tdTime);
                row.appendChild(tdPerformance);

                document.getElementById('registered').appendChild(row);
              }
            }
          };
          xhttp.open("POST", "assign13.php", true);
          xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
          xhttp.send(vars);
        }
      }

      function loadDisplay() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            let response = this.responseText.split("\n");
            for (let i = 0; i < response.length - 1; i++) {
              let cells = response[i].split(",");
              var row = document.createElement('tr');
              var tdName = document.createElement('td');
              var tdLocation = document.createElement('td');
              var tdTime = document.createElement('td');
              var tdPerformance = document.createElement('td');

              tdName.textContent = cells[0];
              tdLocation.innerHTML = cells[1];
              tdTime.textContent = cells[2];
              tdPerformance.textContent = cells[3];

              row.appendChild(tdName);
              row.appendChild(tdLocation);
              row.appendChild(tdTime);
              row.appendChild(tdPerformance);

              document.getElementById('registered').appendChild(row);
            }
          } else if (this.status == 404) {
            exit;
          }
        };
        xhttp.open("POST", "data/students.txt", true);
        xhttp.send();
      }
    </script>

  </footer>

</body>

</html>